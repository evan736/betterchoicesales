(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{6150:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return s(7381)}])},7381:function(e,t,s){"use strict";s.r(t);var l=s(5893),a=s(7294),r=s(1163),i=s(9835),n=s(3740),d=s(8856);let c=["admin","manager","producer","retention_specialist"],o=()=>{var e;let[t,s]=(0,a.useState)([]),[r,i]=(0,a.useState)(!0),[n,o]=(0,a.useState)(!1),[x,m]=(0,a.useState)(null),[p,u]=(0,a.useState)(null),[h,b]=(0,a.useState)(""),[v,j]=(0,a.useState)({email:"",username:"",full_name:"",password:"",role:"producer",producer_code:"",commission_tier:1}),[g,N]=(0,a.useState)({});(0,a.useEffect)(()=>{y()},[]);let y=async()=>{try{let e=await d.Sb.listEmployees();s(e.data)}catch(e){console.error(e)}i(!1)},f=async()=>{try{await d.Sb.createEmployee(v),o(!1),j({email:"",username:"",full_name:"",password:"",role:"producer",producer_code:"",commission_tier:1}),y()}catch(s){var e,t;alert((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Failed to create employee")}},w=async()=>{if(x)try{await d.Sb.updateEmployee(x,g),m(null),y()}catch(s){var e,t;alert((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Failed to update")}},_=async e=>{if(confirm("Delete ".concat(e.full_name,"? This cannot be undone.")))try{await d.Sb.deleteEmployee(e.id),y()}catch(e){var t,s;alert((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.detail)||"Failed to delete")}},C=async()=>{if(p&&h)try{await d.Sb.resetPassword(p,h),alert("Password reset successfully"),u(null),b("")}catch(s){var e,t;alert((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Failed to reset password")}},k=e=>{m(e.id),N({email:e.email,full_name:e.full_name,role:e.role,producer_code:e.producer_code||"",commission_tier:e.commission_tier,is_active:e.is_active})};return r?(0,l.jsx)("div",{className:"text-center py-12 text-slate-500",children:"Loading employees..."}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("span",{className:"text-sm text-slate-500",children:[t.length," employees"]}),(0,l.jsx)("button",{onClick:()=>o(!n),className:"bg-slate-900 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-slate-800",children:"+ Add Employee"})]}),n&&(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-5 shadow-sm",children:[(0,l.jsx)("h3",{className:"font-bold text-slate-900 mb-4",children:"New Employee"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[(0,l.jsx)("input",{placeholder:"Full Name *",value:v.full_name,onChange:e=>j({...v,full_name:e.target.value}),className:"border border-slate-300 rounded-lg px-3 py-2 text-sm"}),(0,l.jsx)("input",{placeholder:"Email *",value:v.email,onChange:e=>j({...v,email:e.target.value}),className:"border border-slate-300 rounded-lg px-3 py-2 text-sm"}),(0,l.jsx)("input",{placeholder:"Username *",value:v.username,onChange:e=>j({...v,username:e.target.value}),className:"border border-slate-300 rounded-lg px-3 py-2 text-sm"}),(0,l.jsx)("input",{placeholder:"Password *",type:"password",value:v.password,onChange:e=>j({...v,password:e.target.value}),className:"border border-slate-300 rounded-lg px-3 py-2 text-sm"}),(0,l.jsx)("select",{value:v.role,onChange:e=>j({...v,role:e.target.value}),className:"border border-slate-300 rounded-lg px-3 py-2 text-sm",children:c.map(e=>(0,l.jsx)("option",{value:e,children:e.replace("_"," ")},e))}),(0,l.jsx)("input",{placeholder:"Producer Code",value:v.producer_code,onChange:e=>j({...v,producer_code:e.target.value}),className:"border border-slate-300 rounded-lg px-3 py-2 text-sm"}),(0,l.jsx)("select",{value:v.commission_tier,onChange:e=>j({...v,commission_tier:parseInt(e.target.value)}),className:"border border-slate-300 rounded-lg px-3 py-2 text-sm",children:[1,2,3,4,5,6,7].map(e=>(0,l.jsxs)("option",{value:e,children:["Tier ",e]},e))}),(0,l.jsx)("button",{onClick:f,className:"bg-green-600 text-white rounded-lg px-4 py-2 text-sm font-semibold hover:bg-green-700",children:"Create"})]})]}),(0,l.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{className:"bg-slate-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-slate-600",children:"Name"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-slate-600",children:"Username"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-slate-600",children:"Email"}),(0,l.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-slate-600",children:"Role"}),(0,l.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-slate-600",children:"Code"}),(0,l.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-slate-600",children:"Tier"}),(0,l.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-slate-600",children:"Sales"}),(0,l.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-slate-600",children:"Premium"}),(0,l.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-slate-600",children:"Status"}),(0,l.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-slate-600",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:t.map((e,t)=>{var s;return(0,l.jsx)("tr",{className:"border-t border-slate-100 ".concat(t%2?"bg-slate-50/50":""),children:x===e.id?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("td",{className:"py-2 px-4",children:(0,l.jsx)("input",{value:g.full_name,onChange:e=>N({...g,full_name:e.target.value}),className:"border rounded px-2 py-1 text-sm w-full"})}),(0,l.jsx)("td",{className:"py-2 px-4 text-slate-400 text-xs font-mono",children:e.username}),(0,l.jsx)("td",{className:"py-2 px-4",children:(0,l.jsx)("input",{value:g.email,onChange:e=>N({...g,email:e.target.value}),className:"border rounded px-2 py-1 text-sm w-full"})}),(0,l.jsx)("td",{className:"py-2 px-4 text-center",children:(0,l.jsx)("select",{value:g.role,onChange:e=>N({...g,role:e.target.value}),className:"border rounded px-2 py-1 text-sm",children:c.map(e=>(0,l.jsx)("option",{value:e,children:e.replace("_"," ")},e))})}),(0,l.jsx)("td",{className:"py-2 px-4 text-center",children:(0,l.jsx)("input",{value:g.producer_code,onChange:e=>N({...g,producer_code:e.target.value}),className:"border rounded px-2 py-1 text-xs w-20 text-center"})}),(0,l.jsx)("td",{className:"py-2 px-4 text-center",children:(0,l.jsx)("select",{value:g.commission_tier,onChange:e=>N({...g,commission_tier:parseInt(e.target.value)}),className:"border rounded px-1 py-1 text-sm",children:[1,2,3,4,5,6,7].map(e=>(0,l.jsx)("option",{value:e,children:e},e))})}),(0,l.jsx)("td",{className:"py-2 px-4 text-right text-slate-400",children:e.sale_count}),(0,l.jsxs)("td",{className:"py-2 px-4 text-right text-slate-400",children:["$",(e.total_premium||0).toLocaleString()]}),(0,l.jsx)("td",{className:"py-2 px-4 text-center",children:(0,l.jsxs)("select",{value:g.is_active?"active":"inactive",onChange:e=>N({...g,is_active:"active"===e.target.value}),className:"border rounded px-1 py-1 text-xs",children:[(0,l.jsx)("option",{value:"active",children:"Active"}),(0,l.jsx)("option",{value:"inactive",children:"Inactive"})]})}),(0,l.jsxs)("td",{className:"py-2 px-4 text-center",children:[(0,l.jsx)("button",{onClick:w,className:"text-green-600 font-semibold text-xs mr-2 hover:underline",children:"Save"}),(0,l.jsx)("button",{onClick:()=>m(null),className:"text-slate-400 text-xs hover:underline",children:"Cancel"})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("td",{className:"py-2.5 px-4 font-medium",children:e.full_name}),(0,l.jsx)("td",{className:"py-2.5 px-4 text-slate-500 font-mono text-xs",children:e.username}),(0,l.jsx)("td",{className:"py-2.5 px-4 text-slate-500",children:e.email}),(0,l.jsx)("td",{className:"py-2.5 px-4 text-center",children:(0,l.jsx)("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full capitalize ".concat("admin"===e.role?"bg-purple-100 text-purple-700":"manager"===e.role?"bg-blue-100 text-blue-700":"producer"===e.role?"bg-green-100 text-green-700":"bg-slate-100 text-slate-600"),children:null===(s=e.role)||void 0===s?void 0:s.replace("_"," ")})}),(0,l.jsx)("td",{className:"py-2.5 px-4 text-center font-mono text-xs",children:e.producer_code||"—"}),(0,l.jsx)("td",{className:"py-2.5 px-4 text-center",children:e.commission_tier}),(0,l.jsx)("td",{className:"py-2.5 px-4 text-right",children:e.sale_count}),(0,l.jsxs)("td",{className:"py-2.5 px-4 text-right",children:["$",(e.total_premium||0).toLocaleString()]}),(0,l.jsx)("td",{className:"py-2.5 px-4 text-center",children:(0,l.jsx)("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full ".concat(e.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-600"),children:e.is_active?"Active":"Inactive"})}),(0,l.jsx)("td",{className:"py-2.5 px-4 text-center",children:(0,l.jsxs)("div",{className:"flex items-center justify-center space-x-1",children:[(0,l.jsx)("button",{onClick:()=>k(e),className:"text-blue-600 text-xs font-semibold hover:underline",children:"Edit"}),(0,l.jsx)("button",{onClick:()=>{u(e.id),b("")},className:"text-amber-600 text-xs font-semibold hover:underline",children:"Reset PW"}),(0,l.jsx)("button",{onClick:()=>_(e),className:"text-red-500 text-xs font-semibold hover:underline",children:"Delete"})]})})]})},e.id)})})]})}),p&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>u(null),children:(0,l.jsxs)("div",{className:"bg-white rounded-xl p-6 w-full max-w-sm shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,l.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Reset Password"}),(0,l.jsxs)("p",{className:"text-sm text-slate-500 mb-3",children:["For: ",null===(e=t.find(e=>e.id===p))||void 0===e?void 0:e.full_name]}),(0,l.jsx)("input",{type:"text",placeholder:"New password (min 6 chars)",value:h,onChange:e=>b(e.target.value),className:"w-full border border-slate-300 rounded-lg px-4 py-2.5 text-sm mb-4"}),(0,l.jsxs)("div",{className:"flex space-x-3",children:[(0,l.jsx)("button",{onClick:C,disabled:h.length<6,className:"flex-1 bg-amber-500 text-white font-semibold py-2 rounded-lg hover:bg-amber-600 disabled:opacity-50 text-sm",children:"Reset Password"}),(0,l.jsx)("button",{onClick:()=>u(null),className:"flex-1 border border-slate-300 py-2 rounded-lg text-sm hover:bg-slate-50",children:"Cancel"})]})]})})]})},x=()=>{let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),[i,n]=(0,a.useState)(null),[c,o]=(0,a.useState)({tier_level:0,min_written_premium:0,max_written_premium:null,commission_rate:0,description:""});(0,a.useEffect)(()=>{x()},[]);let x=async()=>{try{let e=await d.Sb.listTiers();t(e.data)}catch(e){console.error(e)}r(!1)},m=async()=>{try{i?await d.Sb.updateTier(i,c):await d.Sb.createTier(c),n(null),o({tier_level:0,min_written_premium:0,max_written_premium:null,commission_rate:0,description:""}),x()}catch(s){var e,t;alert((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Failed to save tier")}},p=async e=>{if(confirm("Delete Tier ".concat(e.tier_level,"?")))try{await d.Sb.deleteTier(e.id),x()}catch(e){var t,s;alert((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.detail)||"Failed")}},u=e=>{n(e.id),o({tier_level:e.tier_level,min_written_premium:e.min_written_premium,max_written_premium:e.max_written_premium,commission_rate:e.commission_rate,description:e.description||""})};return s?(0,l.jsx)("div",{className:"text-center py-12 text-slate-500",children:"Loading..."}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-bold text-slate-900",children:"Commission Tiers"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Monthly written premium brackets determine agent commission rates"})]}),(0,l.jsx)("button",{onClick:()=>{n(null),o({tier_level:e.length+1,min_written_premium:0,max_written_premium:null,commission_rate:0,description:""})},className:"bg-slate-900 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-slate-800",children:"+ Add Tier"})]}),(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{className:"bg-slate-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-slate-600",children:"Tier"}),(0,l.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-slate-600",children:"Min Premium"}),(0,l.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-slate-600",children:"Max Premium"}),(0,l.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-slate-600",children:"Rate"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-slate-600",children:"Description"}),(0,l.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-slate-600",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:e.map((e,t)=>(0,l.jsxs)("tr",{className:"border-t border-slate-100 ".concat(t%2?"bg-slate-50/50":""),children:[(0,l.jsx)("td",{className:"py-2.5 px-4 text-center font-bold",children:e.tier_level}),(0,l.jsxs)("td",{className:"py-2.5 px-4 text-right",children:["$",(e.min_written_premium||0).toLocaleString()]}),(0,l.jsx)("td",{className:"py-2.5 px-4 text-right",children:e.max_written_premium?"$".concat(e.max_written_premium.toLocaleString()):"No limit"}),(0,l.jsxs)("td",{className:"py-2.5 px-4 text-center font-bold text-green-700",children:[(100*e.commission_rate).toFixed(1),"%"]}),(0,l.jsx)("td",{className:"py-2.5 px-4 text-slate-500",children:e.description}),(0,l.jsxs)("td",{className:"py-2.5 px-4 text-center",children:[(0,l.jsx)("button",{onClick:()=>u(e),className:"text-blue-600 text-xs font-semibold hover:underline mr-2",children:"Edit"}),(0,l.jsx)("button",{onClick:()=>p(e),className:"text-red-500 text-xs font-semibold hover:underline",children:"Delete"})]})]},e.id))})]})]}),(null!==i||c.tier_level>0)&&void 0!==c.commission_rate&&(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-5 shadow-sm",children:[(0,l.jsx)("h3",{className:"font-bold text-slate-900 mb-3",children:i?"Edit Tier":"New Tier"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs text-slate-500 mb-1 block",children:"Tier Level"}),(0,l.jsx)("input",{type:"number",value:c.tier_level,onChange:e=>o({...c,tier_level:parseInt(e.target.value)}),className:"border border-slate-300 rounded-lg px-3 py-2 text-sm w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs text-slate-500 mb-1 block",children:"Min Premium ($)"}),(0,l.jsx)("input",{type:"number",value:c.min_written_premium,onChange:e=>o({...c,min_written_premium:parseFloat(e.target.value)}),className:"border border-slate-300 rounded-lg px-3 py-2 text-sm w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs text-slate-500 mb-1 block",children:"Max Premium ($)"}),(0,l.jsx)("input",{type:"number",value:c.max_written_premium||"",onChange:e=>o({...c,max_written_premium:e.target.value?parseFloat(e.target.value):null}),placeholder:"No limit",className:"border border-slate-300 rounded-lg px-3 py-2 text-sm w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs text-slate-500 mb-1 block",children:"Rate (decimal, e.g. 0.05)"}),(0,l.jsx)("input",{type:"number",step:"0.001",value:c.commission_rate,onChange:e=>o({...c,commission_rate:parseFloat(e.target.value)}),className:"border border-slate-300 rounded-lg px-3 py-2 text-sm w-full"})]}),(0,l.jsxs)("div",{className:"flex items-end space-x-2",children:[(0,l.jsx)("button",{onClick:m,className:"bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-green-700 flex-1",children:"Save"}),(0,l.jsx)("button",{onClick:()=>{n(null),o({tier_level:0,min_written_premium:0,max_written_premium:null,commission_rate:0,description:""})},className:"border border-slate-300 px-3 py-2 rounded-lg text-sm hover:bg-slate-50",children:"Cancel"})]})]})]})]})},m=()=>{let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),[i,n]=(0,a.useState)("");(0,a.useEffect)(()=>{c()},[]);let c=async()=>{try{let e=await d.Sb.listLeadSources();t(e.data)}catch(e){console.error(e)}r(!1)},o=async()=>{if(i.trim())try{await d.Sb.addLeadSource({name:i}),n(""),c()}catch(s){var e,t;alert((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Failed")}};return s?(0,l.jsx)("div",{className:"text-center py-12 text-slate-500",children:"Loading..."}):(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"p-5 border-b border-slate-200",children:[(0,l.jsx)("h3",{className:"font-bold text-slate-900",children:"Lead Sources"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Lead sources available when creating sales"})]}),(0,l.jsxs)("div",{className:"p-5",children:[(0,l.jsxs)("div",{className:"flex space-x-3 mb-4",children:[(0,l.jsx)("input",{value:i,onChange:e=>n(e.target.value),placeholder:"New lead source name (e.g. Facebook Ads)",className:"flex-1 border border-slate-300 rounded-lg px-4 py-2.5 text-sm",onKeyDown:e=>"Enter"===e.key&&o()}),(0,l.jsx)("button",{onClick:o,className:"bg-slate-900 text-white px-5 py-2.5 rounded-lg text-sm font-semibold hover:bg-slate-800",children:"Add"})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:e.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between bg-slate-50 rounded-lg px-4 py-3 border border-slate-200",children:[(0,l.jsx)("span",{className:"text-sm font-medium capitalize",children:e.display_name}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)("span",{className:"text-xs text-slate-400",children:[e.sale_count," sales"]}),(0,l.jsx)("button",{onClick:async()=>{if(confirm('Delete lead source "'+e.display_name+'"?'))try{await d.Sb.deleteLeadSource(e.name),c()}catch(e){var t,s;alert((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.detail)||"Failed to delete")}},className:"text-red-400 hover:text-red-600 text-xs font-semibold",title:"Delete source",children:"\xd7"})]})]},e.name))})]})]})})},p=()=>{let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),[i,n]=(0,a.useState)("");(0,a.useEffect)(()=>{c()},[]);let c=async()=>{try{let e=await d.Sb.listCarriers();t(e.data)}catch(e){console.error(e)}r(!1)},o=async()=>{if(i.trim())try{await d.Sb.addCarrier({name:i}),n(""),c()}catch(s){var e,t;alert((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Failed")}};return s?(0,l.jsx)("div",{className:"text-center py-12 text-slate-500",children:"Loading..."}):(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"p-5 border-b border-slate-200",children:[(0,l.jsx)("h3",{className:"font-bold text-slate-900",children:"Carriers"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Insurance carriers used in sales and commission statements"})]}),(0,l.jsxs)("div",{className:"p-5",children:[(0,l.jsxs)("div",{className:"flex space-x-3 mb-4",children:[(0,l.jsx)("input",{value:i,onChange:e=>n(e.target.value),placeholder:"New carrier name (e.g. GEICO)",className:"flex-1 border border-slate-300 rounded-lg px-4 py-2.5 text-sm",onKeyDown:e=>"Enter"===e.key&&o()}),(0,l.jsx)("button",{onClick:o,className:"bg-slate-900 text-white px-5 py-2.5 rounded-lg text-sm font-semibold hover:bg-slate-800",children:"Add"})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:e.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between bg-slate-50 rounded-lg px-4 py-3 border border-slate-200",children:[(0,l.jsx)("span",{className:"text-sm font-medium capitalize",children:e.display_name}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("span",{className:"text-xs text-slate-400 block",children:[e.sale_count," sales"]}),e.statement_count>0&&(0,l.jsxs)("span",{className:"text-xs text-blue-400",children:[e.statement_count," statements"]})]}),(0,l.jsx)("button",{onClick:async()=>{if(confirm('Delete carrier "'+e.display_name+'"?'))try{await d.Sb.deleteCarrier(e.name),c()}catch(e){var t,s;alert((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.detail)||"Failed to delete")}},className:"text-red-400 hover:text-red-600 text-xs font-semibold",title:"Delete carrier",children:"\xd7"})]})]},e.name))})]})]})})},u=()=>{var e;let[t,s]=(0,a.useState)([]),[r,i]=(0,a.useState)(!0),[n,c]=(0,a.useState)(null),[o,x]=(0,a.useState)(""),[m,p]=(0,a.useState)(""),[u,h]=(0,a.useState)(!1);(0,a.useEffect)(()=>{b()},[]);let b=async()=>{try{let e=await d.zG.welcomeTemplates();s(e.data.templates||[])}catch(e){console.error(e)}i(!1)},v=async e=>{if(n===e){c(null);return}c(e),h(!0);try{let t=await d.zG.previewTemplate(e);x(t.data.html||""),p(t.data.subject||"")}catch(e){console.error(e),x('<p style="padding:20px;color:#ef4444;">Failed to load preview</p>')}h(!1)};return r?(0,l.jsx)("div",{className:"text-center py-12 text-slate-500",children:"Loading templates..."}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"p-5 border-b border-slate-200",children:[(0,l.jsx)("h3",{className:"font-bold text-slate-900",children:"Welcome Email Templates"}),(0,l.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[t.length," carrier-specific templates + 1 generic fallback. Click any template to preview."]})]}),(0,l.jsxs)("div",{className:"p-5",children:[(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)("button",{onClick:()=>v("generic"),className:"w-full text-left rounded-xl border-2 border-dashed p-4 transition-all ".concat("generic"===n?"border-blue-400 bg-blue-50":"border-slate-300 hover:border-slate-400 hover:bg-slate-50"),children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-lg",style:{background:"#1a2b5f"},children:(0,l.jsx)("span",{className:"text-white text-sm font-bold",children:"BCI"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-semibold text-slate-900",children:"Generic Fallback Template"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Used when no carrier-specific template exists"})]})]}),(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"generic"===n?"▲ Close":"▼ Preview"})]})})}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:t.map(e=>(0,l.jsxs)("button",{onClick:()=>v(e.key),className:"text-left rounded-xl border p-4 transition-all ".concat(n===e.key?"border-blue-400 bg-blue-50 shadow-md":"border-slate-200 hover:border-slate-300 hover:shadow-sm"),children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-lg flex-shrink-0",style:{backgroundColor:e.accent_color}}),(0,l.jsx)("p",{className:"font-semibold text-slate-900 text-sm leading-tight",children:e.display_name})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[e.has_mobile_app&&(0,l.jsx)("span",{className:"text-[10px] bg-green-100 text-green-700 px-1.5 py-0.5 rounded font-medium",children:"\uD83D\uDCF1 App"}),e.has_online_account&&(0,l.jsx)("span",{className:"text-[10px] bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded font-medium",children:"\uD83C\uDF10 Portal"}),e.has_payment_url&&(0,l.jsx)("span",{className:"text-[10px] bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded font-medium",children:"\uD83D\uDCB3 Pay"}),e.has_claims_phone&&(0,l.jsx)("span",{className:"text-[10px] bg-red-100 text-red-700 px-1.5 py-0.5 rounded font-medium",children:"\uD83D\uDCDE Claims"})]})]},e.key))})]})]}),n&&(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"font-bold text-slate-900 text-sm",children:["Preview: ","generic"===n?"Generic Fallback":null===(e=t.find(e=>e.key===n))||void 0===e?void 0:e.display_name]}),m&&(0,l.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[(0,l.jsx)("span",{className:"font-medium",children:"Subject:"})," ",m]})]}),(0,l.jsx)("button",{onClick:()=>c(null),className:"text-slate-400 hover:text-slate-600 text-lg font-bold px-2",children:"\xd7"})]}),(0,l.jsx)("div",{className:"p-4 bg-slate-100",children:u?(0,l.jsx)("div",{className:"text-center py-12 text-slate-500",children:"Loading preview..."}):(0,l.jsx)("div",{className:"max-w-[600px] mx-auto bg-white rounded-lg shadow-sm overflow-hidden",children:(0,l.jsx)("iframe",{srcDoc:o,title:"Email Preview",className:"w-full border-0",style:{minHeight:"700px"},sandbox:"allow-same-origin"})})})]})]})};t.default=()=>{var e;let{user:t,loading:s}=(0,i.a)(),d=(0,r.useRouter)(),[c,h]=(0,a.useState)("employees");return((0,a.useEffect)(()=>{s||t||d.push("/")},[t,s]),s||!t)?null:(null===(e=t.role)||void 0===e?void 0:e.toLowerCase())!=="admin"?(0,l.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,l.jsx)(n.Z,{}),(0,l.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-20 text-center",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Admin Access Required"}),(0,l.jsx)("p",{className:"text-slate-500",children:"You don't have permission to view this page."})]})]}):(0,l.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,l.jsx)(n.Z,{}),(0,l.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Admin Panel"}),(0,l.jsx)("p",{className:"text-sm text-slate-500 mb-6",children:"Manage employees, commission plans, lead sources, carriers, and email templates"}),(0,l.jsx)("div",{className:"flex space-x-1 bg-white rounded-xl p-1 shadow-sm border border-slate-200 mb-6 overflow-x-auto",children:[{key:"employees",label:"Employees"},{key:"tiers",label:"Commission Plans"},{key:"sources",label:"Lead Sources"},{key:"carriers",label:"Carriers"},{key:"templates",label:"Email Templates"}].map(e=>(0,l.jsx)("button",{onClick:()=>h(e.key),className:"px-5 py-2.5 rounded-lg text-sm font-semibold transition-all whitespace-nowrap ".concat(c===e.key?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-100"),children:e.label},e.key))}),"employees"===c&&(0,l.jsx)(o,{}),"tiers"===c&&(0,l.jsx)(x,{}),"sources"===c&&(0,l.jsx)(m,{}),"carriers"===c&&(0,l.jsx)(p,{}),"templates"===c&&(0,l.jsx)(u,{})]})]})}}},function(e){e.O(0,[597,228,888,774,179],function(){return e(e.s=6150)}),_N_E=e.O()}]);