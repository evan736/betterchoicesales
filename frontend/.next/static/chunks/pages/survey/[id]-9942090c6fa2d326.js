(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[959],{8512:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/survey/[id]",function(){return a(1303)}])},8856:function(e,t,a){"use strict";a.d(t,{Go:function(){return x},JP:function(){return u},Nb:function(){return l},Sb:function(){return p},Tp:function(){return o},X1:function(){return r},fU:function(){return n},id:function(){return m},lq:function(){return c},n9:function(){return i},pR:function(){return h},zG:function(){return d}});let s=a(7066).Z.create({baseURL:"http://localhost:8000"});s.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let o={list:e=>s.get("/api/sales/",{params:e}),get:e=>s.get("/api/sales/".concat(e)),create:e=>s.post("/api/sales/",e),createFromPdf:e=>s.post("/api/sales/create-from-pdf",e),update:(e,t)=>s.patch("/api/sales/".concat(e),t),delete:e=>s.delete("/api/sales/".concat(e)),uploadPDF:(e,t)=>{let a=new FormData;return a.append("file",t),s.post("/api/sales/".concat(e,"/upload-application"),a,{headers:{"Content-Type":"multipart/form-data"}})},extractPDF:e=>{let t=new FormData;return t.append("file",e),s.post("/api/sales/extract-pdf",t,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4})},sendForSignature:(e,t)=>{if(t){let a=new FormData;return a.append("file",t),s.post("/api/sales/".concat(e,"/send-for-signature"),a,{headers:{"Content-Type":"multipart/form-data"},timeout:12e4})}return s.post("/api/sales/".concat(e,"/send-for-signature"),{},{timeout:12e4})},signatureStatus:e=>s.get("/api/sales/".concat(e,"/signature-status")),importCSV:e=>{let t=new FormData;return t.append("file",e),s.post("/api/sales/import-csv",t,{headers:{"Content-Type":"multipart/form-data"},timeout:18e4})}},n={calculate:(e,t)=>s.get("/api/commissions/calculate/".concat(e,"/").concat(t)),myCommissions:e=>s.get("/api/commissions/my-commissions",{params:{period:e}}),myTier:()=>s.get("/api/commissions/my-tier"),tiers:()=>s.get("/api/commissions/tiers"),createTier:e=>s.post("/api/commissions/tiers",e)},r={upload:(e,t,a)=>{let o=new FormData;return o.append("file",a),o.append("carrier",e),o.append("period",t),s.post("/api/reconciliation/upload",o,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4})},list:()=>s.get("/api/reconciliation/"),get:e=>s.get("/api/reconciliation/".concat(e)),match:e=>s.post("/api/reconciliation/".concat(e,"/match")),calculate:e=>s.post("/api/reconciliation/".concat(e,"/calculate")),delete:e=>s.delete("/api/reconciliation/".concat(e)),manualMatch:(e,t)=>s.post("/api/reconciliation/lines/".concat(e,"/match?sale_id=").concat(t)),monthlyPay:e=>s.post("/api/reconciliation/monthly-pay/".concat(e)),getMonthlyPay:e=>s.get("/api/reconciliation/monthly-pay/".concat(e)),agentSheet:(e,t,a,o)=>{let n={};return a&&(n.rate_adjustment=a),o&&(n.bonus=o),s.get("/api/reconciliation/agent-sheet/".concat(e,"/").concat(t),{params:Object.keys(n).length?n:void 0})},agentSheetPdfUrl:(e,t)=>"/api/reconciliation/agent-sheet/".concat(e,"/").concat(t,"/pdf")};t.ZP=s;let i={summary:e=>s.get("/api/analytics/summary",{params:e}),byGroup:e=>s.get("/api/analytics/by-group",{params:e}),salesTable:e=>s.get("/api/analytics/sales-table",{params:e}),filterOptions:()=>s.get("/api/analytics/filter-options"),trending:e=>s.get("/api/analytics/trending",{params:e})},l={submit:(e,t)=>s.post("/api/payroll/submit/".concat(e),{agent_overrides:t||{}}),unlock:e=>s.post("/api/payroll/unlock/".concat(e)),markPaid:e=>s.post("/api/payroll/mark-paid/".concat(e)),history:()=>s.get("/api/payroll/history"),detail:e=>s.get("/api/payroll/detail/".concat(e))},c={overview:e=>s.get("/api/retention/overview",{params:e?{period:e}:{}}),byAgent:e=>s.get("/api/retention/by-agent",{params:e?{period:e}:{}}),byCarrier:e=>s.get("/api/retention/by-carrier",{params:e?{period:e}:{}}),bySource:e=>s.get("/api/retention/by-source",{params:e?{period:e}:{}}),trend:e=>s.get("/api/retention/trend",{params:{months:e||6}}),earlyCancellations:(e,t)=>s.get("/api/retention/early-cancellations",{params:{days:e||90,...t?{period:t}:{}}})},d={sendWelcome:(e,t)=>{if(null==t?void 0:t.file){let a=new FormData;return a.append("file",t.file),s.post("/api/survey/send-welcome/".concat(e),a,{headers:{"Content-Type":"multipart/form-data"},timeout:3e4})}return(null==t?void 0:t.attachSavedPdf)?s.post("/api/survey/send-welcome/".concat(e,"?attach_saved_pdf=true"),{},{timeout:3e4}):s.post("/api/survey/send-welcome/".concat(e))},previewEmail:e=>s.get("/api/survey/preview/".concat(e)),responses:()=>s.get("/api/survey/responses"),stats:()=>s.get("/api/survey/stats"),welcomeTemplates:()=>s.get("/api/survey/welcome-templates"),previewTemplate:e=>s.get("/api/survey/welcome-templates/".concat(encodeURIComponent(e),"/preview"))},p={listEmployees:()=>s.get("/api/admin/employees"),createEmployee:e=>s.post("/api/admin/employees",e),updateEmployee:(e,t)=>s.put("/api/admin/employees/".concat(e),t),deleteEmployee:e=>s.delete("/api/admin/employees/".concat(e)),resetPassword:(e,t)=>s.post("/api/admin/employees/".concat(e,"/reset-password"),{new_password:t}),listTiers:()=>s.get("/api/admin/commission-tiers"),createTier:e=>s.post("/api/admin/commission-tiers",e),updateTier:(e,t)=>s.put("/api/admin/commission-tiers/".concat(e),t),deleteTier:e=>s.delete("/api/admin/commission-tiers/".concat(e)),listLeadSources:()=>s.get("/api/admin/lead-sources"),addLeadSource:e=>s.post("/api/admin/lead-sources",e),listCarriers:()=>s.get("/api/admin/carriers"),addCarrier:e=>s.post("/api/admin/carriers",e),deleteCarrier:e=>s.delete("/api/admin/carriers/"+encodeURIComponent(e)),deleteLeadSource:e=>s.delete("/api/admin/lead-sources/"+encodeURIComponent(e)),surveyStats:()=>s.get("/api/admin/survey-stats"),dropdownOptions:()=>s.get("/api/admin/dropdown-options")},m={clockIn:e=>s.post("/api/timeclock/clock-in",null,{params:e||{}}),clockOut:e=>s.post("/api/timeclock/clock-out",null,{params:e||{}}),status:()=>s.get("/api/timeclock/status"),myHistory:e=>s.get("/api/timeclock/my-history",{params:{month:e}}),adminSummary:e=>s.get("/api/timeclock/admin/summary",{params:{month:e}}),adminEmployeeDetail:(e,t)=>s.get("/api/timeclock/admin/employee/".concat(e),{params:{month:t}}),excuse:(e,t)=>s.post("/api/timeclock/admin/excuse/".concat(e),null,{params:{note:t}}),unexcuse:e=>s.post("/api/timeclock/admin/unexcuse/".concat(e))},u={search:e=>s.get("/api/customers/search",{params:e}),get:e=>s.get("/api/customers/".concat(e)),sync:e=>s.post("/api/customers/".concat(e,"/sync")),importFromNowCerts:e=>s.post("/api/customers/import-from-nowcerts",null,{params:{nowcerts_insured_id:e}}),syncAll:()=>s.post("/api/customers/sync-all"),nowcertsStatus:()=>s.get("/api/customers/nowcerts/status"),agencyStats:()=>s.get("/api/customers/agency-stats"),duplicates:()=>s.get("/api/customers/duplicates"),merge:(e,t)=>s.post("/api/customers/merge",null,{params:{keep_id:e,merge_ids:t.join(",")}})},h={upload:async(e,t)=>{let a=new FileReader,s=await new Promise((t,s)=>{a.onload=()=>t(a.result.split(",")[1]),a.onerror=s,a.readAsDataURL(e)}),o=localStorage.getItem("token"),n=await fetch("/api/nonpay-upload?dry_run=".concat(t?"true":"false"),{method:"POST",headers:{"Content-Type":"application/json",...o?{Authorization:"Bearer ".concat(o)}:{}},body:JSON.stringify({filename:e.name,data:s})}),r=await n.json();if(!n.ok)throw{response:{status:n.status,data:r}};return{data:r}},history:e=>s.get("/api/nonpay/history",{params:{limit:e||20}}),emails:e=>s.get("/api/nonpay/emails",{params:{policy_number:e}}),carriers:()=>s.get("/api/nonpay/carriers"),preview:e=>s.get("/api/nonpay/preview",{params:e}),sendTest:e=>s.post("/api/nonpay/send-test",null,{params:e})},x={list:e=>s.get("/api/quotes/",{params:e}),get:e=>s.get("/api/quotes/".concat(e)),extractPDF:e=>{let t=new FormData;return t.append("file",e),s.post("/api/quotes/extract-pdf",t,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4})},create:e=>s.post("/api/quotes/",e),update:(e,t)=>s.patch("/api/quotes/".concat(e),t),uploadPDF:(e,t)=>{let a=new FormData;return a.append("file",t),s.post("/api/quotes/".concat(e,"/upload-pdf"),a,{headers:{"Content-Type":"multipart/form-data"}})},sendEmail:(e,t)=>s.post("/api/quotes/".concat(e,"/send-email"),t||{}),markConverted:(e,t)=>s.post("/api/quotes/".concat(e,"/mark-converted"),null,{params:t?{sale_id:t}:{}}),markLost:(e,t)=>s.post("/api/quotes/".concat(e,"/mark-lost"),null,{params:{reason:t||"unknown"}}),checkFollowups:()=>s.post("/api/quotes/check-followups"),stats:()=>s.get("/api/quotes/stats/summary")}},1303:function(e,t,a){"use strict";a.r(t);var s=a(5893),o=a(7294),n=a(1163),r=a(8856);let i="https://g.page/r/CcqT2a9FrSoXEBM/review";t.default=()=>{var e,t,a;let l=(0,n.useRouter)(),{id:c,rating:d}=l.query,[p,m]=(0,o.useState)(null),[u,h]=(0,o.useState)(null),[x,g]=(0,o.useState)(""),[f,y]=(0,o.useState)("loading"),[b,w]=(0,o.useState)(""),[v,j]=(0,o.useState)(""),[N,k]=(0,o.useState)(""),[_,C]=(0,o.useState)(!1);(0,o.useEffect)(()=>{l.isReady&&c&&S()},[l.isReady,c]),(0,o.useEffect)(()=>{if(d&&p&&"rate"===f){let e=parseInt(d);e>=1&&e<=5&&(h(e),T(e))}},[d,p,f]);let S=async()=>{try{let e=await r.ZP.get("/api/survey/info/".concat(c));if(m(e.data),e.data.already_submitted){let t=d?parseInt(d):0;t>=4?(y("redirecting"),setTimeout(()=>{window.location.href=i},2500)):t>=1?(w(e.data.client_name||""),y("feedback_form")):y("thankyou")}else y("rate")}catch(e){y("error")}},T=async e=>{let t=e||u;if(t&&c)try{await r.ZP.post("/api/survey/submit",null,{params:{sale_id:c,rating:t,feedback:x||void 0}}),t>=4?(y("redirecting"),setTimeout(()=>{window.location.href=i},2500)):(w((null==p?void 0:p.client_name)||""),y("feedback_form"))}catch(e){t>=4?(y("redirecting"),setTimeout(()=>{window.location.href=i},2500)):(w((null==p?void 0:p.client_name)||""),y("feedback_form"))}},F=async()=>{if(N.trim()){C(!0);try{await r.ZP.post("/api/survey/feedback",{sale_id:parseInt(c),name:b,email:v,message:N,rating:u})}catch(a){let e=encodeURIComponent("Customer Feedback - ".concat(b||(null==p?void 0:p.client_name)||"Customer"," (").concat(u," star)")),t=encodeURIComponent("Name: ".concat(b||(null==p?void 0:p.client_name)||"","\n")+"Email: ".concat(v,"\n")+"Policy: ".concat((null==p?void 0:p.policy_number)||"","\n")+"Carrier: ".concat((null==p?void 0:p.carrier)||"","\n")+"Rating: ".concat(u," out of 5 stars\n\n")+"Feedback:\n".concat(N,"\n"));window.open("mailto:evan@betterchoiceins.com?subject=".concat(e,"&body=").concat(t),"_self")}y("feedback_sent")}};return"loading"===f?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-purple-50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-slate-500 animate-pulse",children:"Loading..."})}):"error"===f?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-purple-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center max-w-md",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDE15"}),(0,s.jsx)("h1",{className:"text-xl font-bold text-slate-900 mb-2",children:"Survey Not Found"}),(0,s.jsx)("p",{className:"text-slate-500",children:"This survey link may have expired or is invalid."})]})}):"redirecting"===f?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center max-w-md w-full",children:[(0,s.jsx)("div",{className:"text-5xl mb-4",children:"\uD83C\uDF1F"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Thank you so much!"}),(0,s.jsxs)("p",{className:"text-slate-600 mb-4",children:["We're thrilled you had a great experience with ",null==p?void 0:p.producer_name,"!"]}),(0,s.jsx)("p",{className:"text-green-700 font-semibold mb-4",children:"Redirecting you to leave a Google review..."}),(0,s.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-green-600 border-t-transparent rounded-full mx-auto mb-6"}),(0,s.jsx)("a",{href:i,className:"text-sm text-green-600 hover:underline",children:"Click here if not redirected automatically"})]})}):"feedback_form"===f?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-lg w-full",children:[(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("img",{src:"/logo-bci.png",alt:"Better Choice Insurance Group",className:"h-14 w-auto mx-auto mb-4"}),(0,s.jsx)("div",{className:"text-4xl mb-3",children:"\uD83D\uDCAC"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"We want to make it right"}),(0,s.jsx)("p",{className:"text-slate-600",children:"We're sorry your experience wasn't 100% satisfactory. Please share more details so we can address your concerns directly."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Your Name"}),(0,s.jsx)("input",{type:"text",value:b,onChange:e=>w(e.target.value),className:"w-full border border-slate-300 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",placeholder:"Your full name"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Your Email"}),(0,s.jsx)("input",{type:"email",value:v,onChange:e=>j(e.target.value),className:"w-full border border-slate-300 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",placeholder:"So we can follow up with you"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"What could we have done better?"}),(0,s.jsx)("textarea",{value:N,onChange:e=>k(e.target.value),className:"w-full border border-slate-300 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",rows:5,placeholder:"Please tell us about your experience — we take every response seriously and will follow up personally."})]}),(0,s.jsx)("button",{onClick:F,disabled:!N.trim()||_,className:"w-full font-semibold py-3.5 rounded-xl text-lg transition-all shadow-lg ".concat(N.trim()&&!_?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700":"bg-slate-200 text-slate-400 cursor-not-allowed"),children:_?"Sending...":"✉️ Send Feedback"})]}),(0,s.jsxs)("div",{className:"mt-6 pt-4 border-t border-slate-100 text-center",children:[(0,s.jsxs)("p",{className:"text-xs text-slate-400",children:["You can also reach us directly at"," ",(0,s.jsx)("a",{href:"mailto:evan@betterchoiceins.com",className:"text-blue-600 hover:underline",children:"evan@betterchoiceins.com"})]}),(0,s.jsxs)("p",{className:"text-xs text-slate-400 mt-1",children:["Policy: ",null==p?void 0:p.policy_number," • ",null==p?void 0:null===(a=p.carrier)||void 0===a?void 0:a.replace("_"," ")]})]})]})}):"feedback_sent"===f?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center max-w-md w-full",children:[(0,s.jsx)("div",{className:"text-5xl mb-4",children:"✅"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Thank You for Your Feedback"}),(0,s.jsx)("p",{className:"text-slate-600 mb-4",children:"We take your concerns seriously and will reach out to you personally to make things right."}),(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"— The Better Choice Insurance Team"})]})}):"thankyou"===f?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-purple-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center max-w-md w-full",children:[(0,s.jsx)("div",{className:"text-5xl mb-4",children:"\uD83D\uDE4F"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Thank You!"}),(0,s.jsx)("p",{className:"text-slate-600",children:"Your feedback helps us improve. We appreciate you choosing Better Choice Insurance Group!"})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-purple-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-lg w-full",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("img",{src:"/logo-bci.png",alt:"Better Choice Insurance Group",className:"h-14 w-auto mx-auto mb-4"}),(0,s.jsxs)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:["How did ",null==p?void 0:null===(e=p.producer_name)||void 0===e?void 0:e.split(" ")[0]," do?"]}),(0,s.jsxs)("p",{className:"text-slate-500",children:["Thanks for choosing Better Choice Insurance Group, ",null==p?void 0:p.client_name,"!"]})]}),(0,s.jsx)("div",{className:"flex justify-center space-x-3 mb-8",children:[1,2,3,4,5].map(e=>(0,s.jsx)("button",{onClick:()=>h(e),className:"text-5xl transition-all duration-200 hover:scale-125 ".concat(u&&e<=u?"drop-shadow-lg scale-110":"opacity-30 grayscale"),children:"⭐"},e))}),u&&u<=3&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"We'd love to know how we can improve:"}),(0,s.jsx)("textarea",{value:x,onChange:e=>g(e.target.value),className:"w-full border border-slate-300 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 outline-none",rows:3,placeholder:"Optional — your feedback helps us get better"})]}),u&&(0,s.jsx)("button",{onClick:()=>T(),className:"w-full bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-semibold py-3.5 rounded-xl text-lg hover:from-purple-700 hover:to-indigo-700 transition-all shadow-lg",children:u>=4?"\uD83C\uDF1F Submit & Share the Love!":"Submit Feedback"}),(0,s.jsx)("div",{className:"mt-8 pt-6 border-t border-slate-100 text-center",children:(0,s.jsxs)("p",{className:"text-xs text-slate-400",children:["Policy: ",null==p?void 0:p.policy_number," • ",null==p?void 0:null===(t=p.carrier)||void 0===t?void 0:t.replace("_"," ")]})})]})})}},1163:function(e,t,a){e.exports=a(3035)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=8512)}),_N_E=e.O()}]);