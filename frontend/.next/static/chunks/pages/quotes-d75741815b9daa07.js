(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[249],{7653:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3756:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6942:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},3217:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6953:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},9769:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},1012:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7764:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2841:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},2027:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1352:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9487:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/quotes",function(){return s(9373)}])},9373:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return q}});var a=s(5893),l=s(7294),i=s(1163),r=s(9835),n=s(3740),c=s(8856),o=s(1012),d=s(3766),p=s(2841),m=s(5077),u=s(3756),x=s(2027),h=s(9858),g=s(7764),b=s(3217),f=s(1352),v=s(7653),y=s(8142),j=s(4297);/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let N=(0,j.Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var _=s(6942),w=s(3742),k=s(6953),C=s(9769);/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let Z=(0,j.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),z={quoted:{bg:"bg-gray-500/20",text:"text-gray-300",label:"Quoted"},sent:{bg:"bg-blue-500/20",text:"text-blue-300",label:"Sent"},bind_requested:{bg:"bg-emerald-500/20",text:"text-emerald-300",label:"Bind Requested"},following_up:{bg:"bg-yellow-500/20",text:"text-yellow-300",label:"Following Up"},converted:{bg:"bg-green-500/20",text:"text-green-300",label:"Converted"},lost:{bg:"bg-red-500/20",text:"text-red-300",label:"Lost"},remarket:{bg:"bg-purple-500/20",text:"text-purple-300",label:"Remarket"}},S=["auto","home","renters","condo","landlord","umbrella","motorcycle","boat","rv","life","commercial","bundled","other"];function q(){let{user:e,loading:t}=(0,r.a)(),s=(0,i.useRouter)(),[f,v]=(0,l.useState)([]),[y,j]=(0,l.useState)(null),[N,_]=(0,l.useState)(!0),[w,k]=(0,l.useState)(!1),[C,Z]=(0,l.useState)("all"),[S,q]=(0,l.useState)(""),[E,M]=(0,l.useState)([]),[R,Q]=(0,l.useState)(null),[G,T]=(0,l.useState)(!1);(0,l.useEffect)(()=>{t||e||s.push("/")},[e,t,s]);let A=(0,l.useCallback)(async()=>{try{_(!0);let e={};"all"!==C&&(e.status=C);let[t,s]=await Promise.all([c.Go.list(e),c.Go.stats()]);v(t.data.quotes||[]),j(s.data)}catch(e){console.error(e)}finally{_(!1)}},[C]);(0,l.useEffect)(()=>{e&&(A(),c.Sb.dropdownOptions().then(e=>{M((e.data.carriers||[]).filter(e=>"string"==typeof e&&e))}).catch(()=>{}))},[e,A]);let U=f.filter(e=>{var t,s,a,l;if(!S)return!0;let i=S.toLowerCase();return(null===(t=e.prospect_name)||void 0===t?void 0:t.toLowerCase().includes(i))||(null===(s=e.carrier)||void 0===s?void 0:s.toLowerCase().includes(i))||(null===(a=e.prospect_email)||void 0===a?void 0:a.toLowerCase().includes(i))||(null===(l=e.policy_type)||void 0===l?void 0:l.toLowerCase().includes(i))});return t||!e?null:(0,a.jsxs)("div",{className:"min-h-screen page-bg",children:[(0,a.jsx)(n.Z,{}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold page-title",children:"Quotes"}),(0,a.jsx)("p",{className:"text-sm page-subtitle mt-1",children:"Quote-to-close pipeline"})]}),(0,a.jsxs)("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold text-white transition-colors",style:{background:"#0ea5e9"},children:[(0,a.jsx)(o.Z,{size:16})," New Quote"]})]}),y&&(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-3 mb-6",children:[{label:"Total",value:y.total_quotes,icon:(0,a.jsx)(d.Z,{size:14})},{label:"MTD",value:y.mtd_quotes,icon:(0,a.jsx)(F,{size:14})},{label:"Sent",value:y.sent,icon:(0,a.jsx)(p.Z,{size:14})},{label:"Active",value:y.active_pipeline,icon:(0,a.jsx)(m.Z,{size:14})},{label:"Won",value:y.converted,icon:(0,a.jsx)(u.Z,{size:14}),color:"#10b981"},{label:"Lost",value:y.lost,icon:(0,a.jsx)(x.Z,{size:14}),color:"#ef4444"},{label:"Close %",value:"".concat(y.conversion_rate,"%"),icon:(0,a.jsx)(h.Z,{size:14}),color:"#0ea5e9"}].map((e,t)=>(0,a.jsxs)("div",{className:"stat-card rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5 mb-1",children:[(0,a.jsx)("span",{style:{color:e.color||"#64748b"},children:e.icon}),(0,a.jsx)("span",{className:"text-xs stat-label",children:e.label})]}),(0,a.jsx)("p",{className:"text-xl font-bold stat-value",style:e.color?{color:e.color}:{},children:e.value})]},t))}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-xs",children:[(0,a.jsx)(g.Z,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search quotes...",value:S,onChange:e=>q(e.target.value),className:"w-full pl-9 pr-3 py-2 rounded-lg text-sm input-field"})]}),(0,a.jsx)("div",{className:"flex gap-1.5 flex-wrap",children:["all","sent","following_up","converted","lost","remarket"].map(e=>{var t,s,l;let i=null!==(l=null==y?void 0:null===(t=y.by_status)||void 0===t?void 0:t[e])&&void 0!==l?l:"";return(0,a.jsxs)("button",{onClick:()=>Z(e),className:"px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ".concat(C===e?"text-white":"filter-chip"),style:C===e?{background:"#0ea5e9"}:{},children:["all"===e?"All":(null===(s=z[e])||void 0===s?void 0:s.label)||e,i>0&&(0,a.jsxs)("span",{className:"ml-1 opacity-70",children:["(",i,")"]})]},e)})})]}),N?(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsx)(b.Z,{size:24,className:"animate-spin text-cyan-400"})}):0===U.length?(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)(d.Z,{size:48,className:"mx-auto mb-4 text-gray-500"}),(0,a.jsx)("p",{className:"text-gray-400",children:"No quotes yet. Create your first quote to get started."})]}):(0,a.jsx)("div",{className:"space-y-2",children:U.map(e=>{var t;let s=z[e.status]||z.quoted;return(0,a.jsx)("div",{className:"card-bg rounded-lg p-4 cursor-pointer hover:border-cyan-500/30 transition-colors border border-transparent",onClick:()=>{Q(e),T(!0)},children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm page-title truncate",children:e.prospect_name}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat(s.bg," ").concat(s.text),children:s.label}),e.pdf_uploaded&&(0,a.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs bg-emerald-500/20 text-emerald-300",children:"PDF"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs page-subtitle flex-wrap",children:[(0,a.jsx)("span",{className:"capitalize",children:null===(t=e.carrier)||void 0===t?void 0:t.replace(/_/g," ")}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{className:"capitalize",children:e.policy_type}),e.prospect_email&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{className:"truncate max-w-[200px]",children:e.prospect_email})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-shrink-0",children:[e.quoted_premium&&(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("p",{className:"text-lg font-bold",style:{color:"#0ea5e9"},children:["$",e.quoted_premium.toLocaleString(void 0,{minimumFractionDigits:2})]})}),(0,a.jsxs)("div",{className:"text-right text-xs page-subtitle",children:[e.email_sent?(0,a.jsxs)("span",{className:"text-blue-400",children:["Sent ",null!=e.days_since_sent?"".concat(e.days_since_sent,"d ago"):""]}):(0,a.jsx)("span",{children:"Not sent"}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{children:e.producer_name})]})]})]})},e.id)})})]}),w&&(0,a.jsx)(D,{children:(0,a.jsx)(P,{carriers:E,onClose:()=>k(!1),onCreated:e=>{k(!1),A(),Q(e),T(!0)}})}),G&&R&&(0,a.jsx)(L,{quote:R,onClose:()=>{T(!1),Q(null)},onRefresh:A})]})}class D extends l.Component{static getDerivedStateFromError(e){return{error:(null==e?void 0:e.message)||String(e)}}render(){return this.state.error?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",children:(0,a.jsxs)("div",{className:"bg-red-900/80 rounded-xl p-6 max-w-lg text-white",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-2",children:"Modal Error"}),(0,a.jsx)("p",{className:"text-sm font-mono break-all",children:this.state.error}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-white/20 rounded",children:"Reload"})]})}):this.props.children}constructor(e){super(e),this.state={error:null}}}function P(e){let{carriers:t,onClose:s,onCreated:i}=e,[r,n]=(0,l.useState)("upload"),[p,m]=(0,l.useState)({prospect_name:"",prospect_email:"",prospect_phone:"",prospect_address:"",prospect_city:"",prospect_state:"",prospect_zip:"",carrier:"",effective_date:"",premium_term:"6 months"}),[u,x]=(0,l.useState)([{policy_type:"auto",quoted_premium:"",notes:"",enabled:!0}]),[h,g]=(0,l.useState)(!1),[j,w]=(0,l.useState)(!1),[k,C]=(0,l.useState)(""),[Z,z]=(0,l.useState)(!1),[q,D]=(0,l.useState)(null),P=(0,l.useRef)(null),F=async e=>{if(!e.name.toLowerCase().endsWith(".pdf")){C("Please upload a PDF file");return}D(e),w(!0),C("");try{let t=(await c.Go.extractPDF(e)).data;m({prospect_name:t.prospect_name||"",prospect_email:t.prospect_email||"",prospect_phone:t.prospect_phone||"",prospect_address:t.prospect_address||"",prospect_city:t.prospect_city||"",prospect_state:t.prospect_state||"",prospect_zip:t.prospect_zip||"",carrier:t.carrier||"",effective_date:t.effective_date||"",premium_term:t.premium_term||"6 months"});let s=t.all_policies||[];s.length>0?x(s.map(e=>({policy_type:e.policy_type||"other",quoted_premium:String(e.written_premium||""),notes:e.notes||"",enabled:!0}))):x([{policy_type:t.policy_type||"other",quoted_premium:t.quoted_premium||"",notes:t.notes||"",enabled:!0}]),n("form")}catch(e){var t,s;C((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.detail)||"PDF extraction failed")}finally{w(!1)}},L=async()=>{let e=u.filter(e=>e.enabled);if(!p.prospect_name||!p.carrier){C("Name and carrier are required");return}if(0===e.length){C("Select at least one policy line");return}g(!0),C("");try{let t=e.reduce((e,t)=>e+(parseFloat(t.quoted_premium)||0),0),s=e.length>1?"bundled":e[0].policy_type,a=e.map(e=>{let t=e.policy_type.charAt(0).toUpperCase()+e.policy_type.slice(1),s=e.quoted_premium?"$".concat(parseFloat(e.quoted_premium).toLocaleString("en-US",{minimumFractionDigits:2})):"";return"".concat(t,": ").concat(s).concat(e.notes?" — "+e.notes:"")}).join(" | "),l=await c.Go.create({...p,policy_type:s,quoted_premium:t||null,notes:a,policy_lines:e.map(e=>({policy_type:e.policy_type,premium:parseFloat(e.quoted_premium)||0,notes:e.notes}))});if(q)try{await c.Go.uploadPDF(l.data.id,q)}catch(e){}i(l.data)}catch(e){var t,s;C((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.detail)||"Failed to create quote")}finally{g(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:s,children:(0,a.jsxs)("div",{className:"modal-bg rounded-xl w-full max-w-xl max-h-[90vh] overflow-y-auto p-6",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold page-title",children:"upload"===r?"New Quote":"Review & Create Quote"}),(0,a.jsx)("button",{onClick:s,className:"p-1 rounded hover:bg-white/10",children:(0,a.jsx)(f.Z,{size:18})})]}),k&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 mb-4 rounded-lg bg-red-500/10 text-red-400 text-sm",children:[(0,a.jsx)(v.Z,{size:14})," ",k]}),"upload"===r&&!j&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border-2 border-dashed rounded-xl p-10 text-center transition-colors cursor-pointer ".concat(Z?"border-cyan-400 bg-cyan-400/10":"border-gray-600 hover:border-gray-400"),onDragOver:e=>{e.preventDefault(),z(!0)},onDragLeave:()=>z(!1),onDrop:e=>{e.preventDefault(),z(!1);let t=e.dataTransfer.files[0];t&&F(t)},onClick:()=>{var e;return null===(e=P.current)||void 0===e?void 0:e.click()},children:[(0,a.jsx)(y.Z,{size:36,className:"mx-auto mb-3 text-gray-400"}),(0,a.jsx)("p",{className:"text-sm font-medium page-title mb-1",children:"Drop a quote PDF here"}),(0,a.jsx)("p",{className:"text-xs page-subtitle",children:"or click to browse"}),(0,a.jsx)("input",{ref:P,type:"file",accept:".pdf",className:"hidden",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&F(s)}})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"flex-1 h-px bg-gray-700"}),(0,a.jsx)("span",{className:"text-xs page-subtitle",children:"or"}),(0,a.jsx)("div",{className:"flex-1 h-px bg-gray-700"})]}),(0,a.jsx)("button",{onClick:()=>n("form"),className:"w-full py-2.5 rounded-lg text-sm font-medium filter-chip text-center",children:"Enter manually"})]}),j&&(0,a.jsxs)("div",{className:"py-12 text-center",children:[(0,a.jsx)(b.Z,{size:32,className:"mx-auto mb-3 animate-spin text-cyan-400"}),(0,a.jsx)("p",{className:"text-sm font-medium page-title",children:"Extracting quote details..."}),(0,a.jsx)("p",{className:"text-xs page-subtitle mt-1",children:"Reading PDF with AI"})]}),"form"===r&&!j&&(0,a.jsxs)(a.Fragment,{children:[q&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2 mb-4 rounded-lg bg-cyan-500/10 text-cyan-400 text-xs",children:[(0,a.jsx)(d.Z,{size:14}),(0,a.jsxs)("span",{children:["Extracted from: ",q.name]}),(0,a.jsx)("button",{onClick:()=>{D(null),n("upload"),m({prospect_name:"",prospect_email:"",prospect_phone:"",prospect_address:"",prospect_city:"",prospect_state:"",prospect_zip:"",carrier:"",effective_date:"",premium_term:"6 months"}),x([{policy_type:"auto",quoted_premium:"",notes:"",enabled:!0}])},className:"ml-auto hover:text-white",children:(0,a.jsx)(N,{size:12})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Prospect Name *"}),(0,a.jsx)("input",{type:"text",value:p.prospect_name,onChange:e=>m({...p,prospect_name:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",placeholder:"John Smith"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Email"}),(0,a.jsx)("input",{type:"email",value:p.prospect_email,onChange:e=>m({...p,prospect_email:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",placeholder:"john@example.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Phone"}),(0,a.jsx)("input",{type:"tel",value:p.prospect_phone,onChange:e=>m({...p,prospect_phone:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",placeholder:"(317) 555-1234"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Address"}),(0,a.jsx)("input",{type:"text",value:p.prospect_address,onChange:e=>m({...p,prospect_address:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",placeholder:"123 Main St"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsx)("input",{type:"text",value:p.prospect_city,onChange:e=>m({...p,prospect_city:e.target.value}),className:"px-3 py-2 rounded-lg text-sm input-field",placeholder:"City"}),(0,a.jsx)("input",{type:"text",value:p.prospect_state,onChange:e=>m({...p,prospect_state:e.target.value}),className:"px-3 py-2 rounded-lg text-sm input-field",placeholder:"State",maxLength:2}),(0,a.jsx)("input",{type:"text",value:p.prospect_zip,onChange:e=>m({...p,prospect_zip:e.target.value}),className:"px-3 py-2 rounded-lg text-sm input-field",placeholder:"Zip",maxLength:5})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Carrier *"}),(0,a.jsxs)("select",{value:p.carrier,onChange:e=>m({...p,carrier:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",children:[(0,a.jsx)("option",{value:"",children:"Select carrier"}),p.carrier&&!t.includes(p.carrier)&&(0,a.jsx)("option",{value:p.carrier,children:p.carrier.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}),t.filter(e=>"string"==typeof e&&e).map(e=>(0,a.jsx)("option",{value:e,children:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())},e))]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Effective Date"}),(0,a.jsx)("input",{type:"date",value:p.effective_date,onChange:e=>m({...p,effective_date:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Policy Term"}),(0,a.jsxs)("select",{value:p.premium_term,onChange:e=>m({...p,premium_term:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",children:[(0,a.jsx)("option",{value:"6 months",children:"6 Months"}),(0,a.jsx)("option",{value:"12 months",children:"12 Months"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("label",{className:"text-xs font-medium page-subtitle",children:["Policy Lines ",u.length>1&&"(".concat(u.filter(e=>e.enabled).length," selected)")]}),1===u.length&&(0,a.jsx)("button",{type:"button",onClick:()=>x([...u,{policy_type:"auto",quoted_premium:"",notes:"",enabled:!0}]),className:"text-xs text-cyan-400 hover:text-cyan-300",children:"+ Add line"})]}),(0,a.jsx)("div",{className:"space-y-2",children:u.map((e,t)=>(0,a.jsxs)("div",{className:"rounded-lg border p-3 transition-colors ".concat(e.enabled?"border-cyan-500/30 bg-cyan-500/5":"border-gray-700 bg-gray-800/30 opacity-50"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[u.length>1&&(0,a.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:e=>{let s=[...u];s[t]={...s[t],enabled:e.target.checked},x(s)},className:"rounded"}),(0,a.jsx)("select",{value:e.policy_type,onChange:e=>{let s=[...u];s[t]={...s[t],policy_type:e.target.value},x(s)},className:"flex-1 px-2 py-1.5 rounded text-sm input-field",children:S.map(e=>(0,a.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(_.Z,{size:12,className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400"}),(0,a.jsx)("input",{type:"number",step:"0.01",value:e.quoted_premium,onChange:e=>{let s=[...u];s[t]={...s[t],quoted_premium:e.target.value},x(s)},className:"w-full pl-6 pr-2 py-1.5 rounded text-sm input-field",placeholder:"Premium"})]})]}),e.notes&&(0,a.jsx)("p",{className:"text-xs page-subtitle pl-6 truncate",children:e.notes})]},t))}),u.length>1&&(0,a.jsxs)("div",{className:"flex justify-between mt-2 text-xs page-subtitle",children:[(0,a.jsxs)("span",{children:["Total: ",u.filter(e=>e.enabled).length," lines"]}),(0,a.jsxs)("span",{className:"font-medium",style:{color:"#0ea5e9"},children:["$",u.filter(e=>e.enabled).reduce((e,t)=>e+(parseFloat(t.quoted_premium)||0),0).toLocaleString("en-US",{minimumFractionDigits:2})]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 rounded-lg text-sm font-medium filter-chip",children:"Cancel"}),(0,a.jsxs)("button",{onClick:L,disabled:h,className:"flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold text-white",style:{background:"#0ea5e9"},children:[h?(0,a.jsx)(b.Z,{size:14,className:"animate-spin"}):(0,a.jsx)(o.Z,{size:14}),"Create Quote"]})]})]})]})})}function F(e){let{size:t}=e;return(0,a.jsx)(m.Z,{size:t})}function L(e){var t;let{quote:s,onClose:i,onRefresh:r}=e,[n,o]=(0,l.useState)(s),[h,g]=(0,l.useState)(!1),[j,N]=(0,l.useState)(!1),[_,S]=(0,l.useState)(!1),[q,D]=(0,l.useState)(""),[P,F]=(0,l.useState)(s.premium_term||"6 months"),[L,E]=(0,l.useState)(""),[M,R]=(0,l.useState)("success"),Q=(0,l.useRef)(null),[G,T]=(0,l.useState)(""),[A,U]=(0,l.useState)(!1),[O,$]=(0,l.useState)(!1),W=z[n.status]||z.quoted,X=async()=>{try{let e=await c.Go.get(n.id);o(e.data)}catch(e){}},B=async e=>{if(!e.name.toLowerCase().endsWith(".pdf")){E("Only PDF files allowed"),R("error");return}g(!0);try{await c.Go.uploadPDF(n.id,e),E("".concat(e.name," uploaded")),R("success"),await X(),r()}catch(e){var t,s;E((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.detail)||"Upload failed"),R("error")}finally{g(!1)}},H=async()=>{N(!0),E("");try{let e=await c.Go.sendEmail(n.id,{additional_notes:q||void 0,premium_term:P});e.data.email_sent?(E("Quote email sent successfully!"),R("success"),await X(),r()):(E(e.data.error||"Failed to send"),R("error"))}catch(s){var e,t;E((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Failed to send email"),R("error")}finally{N(!1)}},I=async()=>{try{await c.Go.markConverted(n.id),E("Marked as converted!"),R("success"),await X(),r()}catch(e){}},J=async()=>{let e=prompt("Reason for losing this quote?","Went with another carrier");if(null!==e)try{await c.Go.markLost(n.id,e),E("Marked as lost"),R("success"),await X(),r()}catch(e){}};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:i,children:(0,a.jsxs)("div",{className:"modal-bg rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto p-6",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold page-title",children:n.prospect_name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat(W.bg," ").concat(W.text),children:W.label}),(0,a.jsxs)("span",{className:"text-xs page-subtitle capitalize",children:[null===(t=n.carrier)||void 0===t?void 0:t.replace(/_/g," ")," • ",n.policy_type]})]})]}),(0,a.jsx)("button",{onClick:i,className:"p-1 rounded hover:bg-white/10",children:(0,a.jsx)(f.Z,{size:18})})]}),L&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 mb-4 rounded-lg text-sm ".concat("success"===M?"bg-emerald-500/10 text-emerald-400":"bg-red-500/10 text-red-400"),children:["success"===M?(0,a.jsx)(w.Z,{size:14}):(0,a.jsx)(v.Z,{size:14}),L]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-5",children:[(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[n.prospect_email&&(0,a.jsxs)("div",{className:"flex items-center gap-2 page-subtitle",children:[(0,a.jsx)(k.Z,{size:13})," ",n.prospect_email]}),n.prospect_phone&&(0,a.jsxs)("div",{className:"flex items-center gap-2 page-subtitle",children:[(0,a.jsx)(C.Z,{size:13})," ",n.prospect_phone]}),(n.prospect_city||n.prospect_state)&&(0,a.jsx)("div",{className:"page-subtitle text-xs",children:[n.prospect_address,n.prospect_city,n.prospect_state,n.prospect_zip].filter(Boolean).join(", ")})]}),(0,a.jsxs)("div",{className:"text-right",children:[n.quoted_premium&&(0,a.jsxs)("p",{className:"text-2xl font-bold",style:{color:"#0ea5e9"},children:["$",n.quoted_premium.toLocaleString(void 0,{minimumFractionDigits:2})]}),(0,a.jsxs)("p",{className:"text-xs page-subtitle mt-1",children:["Producer: ",n.producer_name]}),n.effective_date&&(0,a.jsxs)("p",{className:"text-xs page-subtitle",children:["Effective: ",new Date(n.effective_date).toLocaleDateString()]})]})]}),n.policy_lines&&n.policy_lines.length>1&&(0,a.jsxs)("div",{className:"mb-5",children:[(0,a.jsx)("p",{className:"text-xs font-medium page-subtitle mb-2",children:"Coverage Breakdown"}),(0,a.jsx)("div",{className:"space-y-1.5",children:n.policy_lines.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 rounded-lg bg-white/5 text-sm",children:[(0,a.jsx)("span",{className:"capitalize page-title",children:(e.policy_type||"").replace(/_/g," ")}),(0,a.jsxs)("span",{className:"font-semibold",style:{color:"#0ea5e9"},children:["$",(e.premium||0).toLocaleString(void 0,{minimumFractionDigits:2})]})]},t))})]}),n.email_sent&&(0,a.jsxs)("div",{className:"mb-5",children:[(0,a.jsx)("p",{className:"text-xs font-medium page-subtitle mb-2",children:"Pipeline Progress"}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:[{label:"Sent",done:n.email_sent},{label:"3-Day",done:n.followup_3day_sent},{label:"7-Day",done:n.followup_7day_sent},{label:"14-Day",done:n.followup_14day_sent},{label:"Remarket",done:n.entered_remarket}].map((e,t)=>(0,a.jsxs)(l.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ".concat(e.done?"bg-cyan-500/20 text-cyan-300":"bg-white/5 text-gray-500"),children:[e.done?(0,a.jsx)(w.Z,{size:10}):(0,a.jsx)(m.Z,{size:10}),e.label]}),t<4&&(0,a.jsx)("div",{className:"w-4 h-0.5 ".concat(e.done?"bg-cyan-500/40":"bg-white/10")})]},t))})]}),(0,a.jsxs)("div",{className:"mb-5",children:[(0,a.jsx)("p",{className:"text-xs font-medium page-subtitle mb-2",children:"Quote PDF"}),n.pdf_uploaded?(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/20",children:[(0,a.jsx)(d.Z,{size:18,className:"text-emerald-400"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-emerald-300",children:n.pdf_filename}),(0,a.jsx)("p",{className:"text-xs text-emerald-400/60",children:"PDF attached — will be included in quote email"})]}),(0,a.jsx)("button",{onClick:()=>{var e;return null===(e=Q.current)||void 0===e?void 0:e.click()},className:"text-xs text-cyan-400 hover:underline",children:"Replace"})]}):(0,a.jsx)("div",{onDragOver:e=>{e.preventDefault(),S(!0)},onDragLeave:()=>S(!1),onDrop:e=>{e.preventDefault(),S(!1);let t=e.dataTransfer.files[0];t&&B(t)},onClick:()=>{var e;return null===(e=Q.current)||void 0===e?void 0:e.click()},className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ".concat(_?"border-cyan-400 bg-cyan-400/10":"border-white/10 hover:border-white/20"),children:h?(0,a.jsx)(b.Z,{size:24,className:"mx-auto animate-spin text-cyan-400"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{size:28,className:"mx-auto mb-2 text-gray-400"}),(0,a.jsx)("p",{className:"text-sm page-subtitle",children:"Drag & drop quote PDF here"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"or click to browse"})]})}),(0,a.jsx)("input",{ref:Q,type:"file",accept:".pdf",className:"hidden",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&B(s),e.target.value=""}})]}),!n.email_sent&&n.prospect_email&&n.quoted_premium&&!n.pdf_uploaded&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 mb-5 rounded-lg bg-yellow-500/10 text-yellow-400 text-sm",children:[(0,a.jsx)(v.Z,{size:14}),"Upload a quote PDF before sending"]}),!n.email_sent&&n.prospect_email&&n.quoted_premium&&n.pdf_uploaded&&(0,a.jsxs)("div",{className:"mb-5 p-4 rounded-lg border border-white/10 bg-white/5",children:[(0,a.jsx)("p",{className:"text-sm font-medium page-title mb-3",children:"Send Quote Email"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs page-subtitle mb-1",children:"Premium Term"}),(0,a.jsxs)("select",{value:P,onChange:e=>F(e.target.value),className:"w-full px-3 py-2 rounded-lg text-sm input-field",children:[(0,a.jsx)("option",{value:"6 months",children:"6 Months"}),(0,a.jsx)("option",{value:"12 months",children:"12 Months"})]})]})}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{className:"block text-xs page-subtitle mb-1",children:"Personal Note (optional)"}),(0,a.jsx)("textarea",{value:q,onChange:e=>D(e.target.value),rows:2,className:"w-full px-3 py-2 rounded-lg text-sm input-field",placeholder:"e.g., This is $120 less than your current carrier!"})]}),A&&G&&(0,a.jsxs)("div",{className:"mb-3 rounded-lg border border-white/10 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 bg-white/5",children:[(0,a.jsx)("span",{className:"text-xs font-medium page-subtitle",children:"Email Preview"}),(0,a.jsx)("button",{onClick:()=>U(!1),className:"text-xs page-subtitle hover:text-white",children:"Close"})]}),(0,a.jsx)("div",{className:"bg-white rounded-b",style:{maxHeight:"400px",overflow:"auto"},children:(0,a.jsx)("iframe",{srcDoc:G,className:"w-full border-0",style:{height:"400px"},title:"Email Preview"})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:async()=>{$(!0);try{let e=await c.Go.emailPreview(n.id);T(e.data.html),U(!0)}catch(s){var e,t;E((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Preview failed"),R("error")}finally{$(!1)}},disabled:O,className:"flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium filter-chip",children:[O?(0,a.jsx)(b.Z,{size:14,className:"animate-spin"}):(0,a.jsx)(Z,{size:14}),"Preview"]}),(0,a.jsxs)("button",{onClick:H,disabled:j,className:"flex-1 flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold text-white justify-center",style:{background:"#0ea5e9"},children:[j?(0,a.jsx)(b.Z,{size:14,className:"animate-spin"}):(0,a.jsx)(p.Z,{size:14}),"Send Quote Email"]})]}),(0,a.jsx)("p",{className:"text-xs page-subtitle mt-2 opacity-60",children:"Sending will also create a prospect in NowCerts"})]}),n.email_sent&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 mb-5 rounded-lg bg-blue-500/10 text-blue-400 text-sm",children:[(0,a.jsx)(w.Z,{size:14}),"Quote emailed on ",new Date(n.email_sent_at).toLocaleDateString()," at ",new Date(n.email_sent_at).toLocaleTimeString(),n.nowcerts_prospect_created&&" • NowCerts prospect created"]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:["converted"!==n.status&&"lost"!==n.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:I,className:"flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium bg-emerald-500/20 text-emerald-300 hover:bg-emerald-500/30 transition-colors",children:[(0,a.jsx)(u.Z,{size:14})," Won — Converted to Sale"]}),(0,a.jsxs)("button",{onClick:J,className:"flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:[(0,a.jsx)(x.Z,{size:14})," Lost"]})]}),"lost"===n.status&&n.lost_reason&&(0,a.jsxs)("div",{className:"text-xs page-subtitle",children:["Lost reason: ",n.lost_reason]})]})]})})}}},function(e){e.O(0,[597,228,888,774,179],function(){return e(e.s=9487)}),_N_E=e.O()}]);