(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[249],{7653:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3756:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6942:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},3217:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6953:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},9769:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},1012:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7764:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2841:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},2027:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1352:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(4297).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9487:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/quotes",function(){return s(3299)}])},3299:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Z}});var l=s(5893),a=s(7294),r=s(1163),i=s(9835),n=s(3740),c=s(8856),o=s(1012),d=s(3766),p=s(2841),u=s(5077),x=s(3756),m=s(2027),h=s(9858),g=s(7764),f=s(3217),b=s(1352),v=s(7653),j=s(6942),y=s(3742),N=s(6953),_=s(9769),w=s(8142);let k={quoted:{bg:"bg-gray-500/20",text:"text-gray-300",label:"Quoted"},sent:{bg:"bg-blue-500/20",text:"text-blue-300",label:"Sent"},following_up:{bg:"bg-yellow-500/20",text:"text-yellow-300",label:"Following Up"},converted:{bg:"bg-green-500/20",text:"text-green-300",label:"Converted"},lost:{bg:"bg-red-500/20",text:"text-red-300",label:"Lost"},remarket:{bg:"bg-purple-500/20",text:"text-purple-300",label:"Remarket"}},C=["auto","home","renters","condo","landlord","umbrella","motorcycle","boat","rv","life","commercial","bundled","other"];function Z(){let{user:e,loading:t}=(0,i.a)(),s=(0,r.useRouter)(),[b,v]=(0,a.useState)([]),[j,y]=(0,a.useState)(null),[N,_]=(0,a.useState)(!0),[w,C]=(0,a.useState)(!1),[Z,P]=(0,a.useState)("all"),[L,F]=(0,a.useState)(""),[E,M]=(0,a.useState)([]),[Q,T]=(0,a.useState)(null),[G,R]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t||e||s.push("/")},[e,t,s]);let A=(0,a.useCallback)(async()=>{try{_(!0);let e={};"all"!==Z&&(e.status=Z);let[t,s]=await Promise.all([c.Go.list(e),c.Go.stats()]);v(t.data.quotes||[]),y(s.data)}catch(e){console.error(e)}finally{_(!1)}},[Z]);(0,a.useEffect)(()=>{e&&(A(),c.Sb.dropdownOptions().then(e=>{M((e.data.carriers||[]).filter(e=>"string"==typeof e&&e))}).catch(()=>{}))},[e,A]);let O=b.filter(e=>{var t,s,l,a;if(!L)return!0;let r=L.toLowerCase();return(null===(t=e.prospect_name)||void 0===t?void 0:t.toLowerCase().includes(r))||(null===(s=e.carrier)||void 0===s?void 0:s.toLowerCase().includes(r))||(null===(l=e.prospect_email)||void 0===l?void 0:l.toLowerCase().includes(r))||(null===(a=e.policy_type)||void 0===a?void 0:a.toLowerCase().includes(r))});return t||!e?null:(0,l.jsxs)("div",{className:"min-h-screen page-bg",children:[(0,l.jsx)(n.Z,{}),(0,l.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-6",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold page-title",children:"Quotes"}),(0,l.jsx)("p",{className:"text-sm page-subtitle mt-1",children:"Quote-to-close pipeline"})]}),(0,l.jsxs)("button",{onClick:()=>C(!0),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold text-white transition-colors",style:{background:"#0ea5e9"},children:[(0,l.jsx)(o.Z,{size:16})," New Quote"]})]}),j&&(0,l.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-3 mb-6",children:[{label:"Total",value:j.total_quotes,icon:(0,l.jsx)(d.Z,{size:14})},{label:"MTD",value:j.mtd_quotes,icon:(0,l.jsx)(q,{size:14})},{label:"Sent",value:j.sent,icon:(0,l.jsx)(p.Z,{size:14})},{label:"Active",value:j.active_pipeline,icon:(0,l.jsx)(u.Z,{size:14})},{label:"Won",value:j.converted,icon:(0,l.jsx)(x.Z,{size:14}),color:"#10b981"},{label:"Lost",value:j.lost,icon:(0,l.jsx)(m.Z,{size:14}),color:"#ef4444"},{label:"Close %",value:"".concat(j.conversion_rate,"%"),icon:(0,l.jsx)(h.Z,{size:14}),color:"#0ea5e9"}].map((e,t)=>(0,l.jsxs)("div",{className:"stat-card rounded-lg p-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 mb-1",children:[(0,l.jsx)("span",{style:{color:e.color||"#64748b"},children:e.icon}),(0,l.jsx)("span",{className:"text-xs stat-label",children:e.label})]}),(0,l.jsx)("p",{className:"text-xl font-bold stat-value",style:e.color?{color:e.color}:{},children:e.value})]},t))}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[(0,l.jsxs)("div",{className:"relative flex-1 max-w-xs",children:[(0,l.jsx)(g.Z,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,l.jsx)("input",{type:"text",placeholder:"Search quotes...",value:L,onChange:e=>F(e.target.value),className:"w-full pl-9 pr-3 py-2 rounded-lg text-sm input-field"})]}),(0,l.jsx)("div",{className:"flex gap-1.5 flex-wrap",children:["all","quoted","sent","following_up","converted","lost","remarket"].map(e=>{var t;return(0,l.jsx)("button",{onClick:()=>P(e),className:"px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ".concat(Z===e?"text-white":"filter-chip"),style:Z===e?{background:"#0ea5e9"}:{},children:"all"===e?"All":(null===(t=k[e])||void 0===t?void 0:t.label)||e},e)})})]}),N?(0,l.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,l.jsx)(f.Z,{size:24,className:"animate-spin text-cyan-400"})}):0===O.length?(0,l.jsxs)("div",{className:"text-center py-20",children:[(0,l.jsx)(d.Z,{size:48,className:"mx-auto mb-4 text-gray-500"}),(0,l.jsx)("p",{className:"text-gray-400",children:"No quotes yet. Create your first quote to get started."})]}):(0,l.jsx)("div",{className:"space-y-2",children:O.map(e=>{var t;let s=k[e.status]||k.quoted;return(0,l.jsx)("div",{className:"card-bg rounded-lg p-4 cursor-pointer hover:border-cyan-500/30 transition-colors border border-transparent",onClick:()=>{T(e),R(!0)},children:(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,l.jsx)("h3",{className:"font-semibold text-sm page-title truncate",children:e.prospect_name}),(0,l.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat(s.bg," ").concat(s.text),children:s.label}),e.pdf_uploaded&&(0,l.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs bg-emerald-500/20 text-emerald-300",children:"PDF"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs page-subtitle flex-wrap",children:[(0,l.jsx)("span",{className:"capitalize",children:null===(t=e.carrier)||void 0===t?void 0:t.replace(/_/g," ")}),(0,l.jsx)("span",{children:"•"}),(0,l.jsx)("span",{className:"capitalize",children:e.policy_type}),e.prospect_email&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"•"}),(0,l.jsx)("span",{className:"truncate max-w-[200px]",children:e.prospect_email})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4 flex-shrink-0",children:[e.quoted_premium&&(0,l.jsx)("div",{className:"text-right",children:(0,l.jsxs)("p",{className:"text-lg font-bold",style:{color:"#0ea5e9"},children:["$",e.quoted_premium.toLocaleString(void 0,{minimumFractionDigits:2})]})}),(0,l.jsxs)("div",{className:"text-right text-xs page-subtitle",children:[e.email_sent?(0,l.jsxs)("span",{className:"text-blue-400",children:["Sent ",null!=e.days_since_sent?"".concat(e.days_since_sent,"d ago"):""]}):(0,l.jsx)("span",{children:"Not sent"}),(0,l.jsx)("br",{}),(0,l.jsx)("span",{children:e.producer_name})]})]})]})},e.id)})})]}),w&&(0,l.jsx)(z,{children:(0,l.jsx)(S,{carriers:E,onClose:()=>C(!1),onCreated:e=>{C(!1),A(),T(e),R(!0)}})}),G&&Q&&(0,l.jsx)(D,{quote:Q,onClose:()=>{R(!1),T(null)},onRefresh:A})]})}class z extends a.Component{static getDerivedStateFromError(e){return{error:(null==e?void 0:e.message)||String(e)}}render(){return this.state.error?(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",children:(0,l.jsxs)("div",{className:"bg-red-900/80 rounded-xl p-6 max-w-lg text-white",children:[(0,l.jsx)("h2",{className:"text-lg font-bold mb-2",children:"Modal Error"}),(0,l.jsx)("p",{className:"text-sm font-mono break-all",children:this.state.error}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-white/20 rounded",children:"Reload"})]})}):this.props.children}constructor(e){super(e),this.state={error:null}}}function S(e){let{carriers:t,onClose:s,onCreated:r}=e,[i,n]=(0,a.useState)({prospect_name:"",prospect_email:"",prospect_phone:"",prospect_address:"",prospect_city:"",prospect_state:"",prospect_zip:"",carrier:"",policy_type:"auto",quoted_premium:"",effective_date:"",notes:""}),[d,p]=(0,a.useState)(!1),[u,x]=(0,a.useState)(""),m=async()=>{if(!i.prospect_name||!i.carrier){x("Name and carrier are required");return}p(!0),x("");try{let e=await c.Go.create({...i,quoted_premium:i.quoted_premium?parseFloat(i.quoted_premium):null});r(e.data)}catch(s){var e,t;x((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Failed to create quote")}finally{p(!1)}};return(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:s,children:(0,l.jsxs)("div",{className:"modal-bg rounded-xl w-full max-w-xl max-h-[90vh] overflow-y-auto p-6",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h2",{className:"text-lg font-bold page-title",children:"New Quote"}),(0,l.jsx)("button",{onClick:s,className:"p-1 rounded hover:bg-white/10",children:(0,l.jsx)(b.Z,{size:18})})]}),u&&(0,l.jsxs)("div",{className:"flex items-center gap-2 p-3 mb-4 rounded-lg bg-red-500/10 text-red-400 text-sm",children:[(0,l.jsx)(v.Z,{size:14})," ",u]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Prospect Name *"}),(0,l.jsx)("input",{type:"text",value:i.prospect_name,onChange:e=>n({...i,prospect_name:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",placeholder:"John Smith"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Email"}),(0,l.jsx)("input",{type:"email",value:i.prospect_email,onChange:e=>n({...i,prospect_email:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",placeholder:"john@example.com"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Phone"}),(0,l.jsx)("input",{type:"tel",value:i.prospect_phone,onChange:e=>n({...i,prospect_phone:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",placeholder:"(614) 555-1234"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Address"}),(0,l.jsx)("input",{type:"text",value:i.prospect_address,onChange:e=>n({...i,prospect_address:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",placeholder:"123 Main St"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsx)("input",{type:"text",value:i.prospect_city,onChange:e=>n({...i,prospect_city:e.target.value}),className:"px-3 py-2 rounded-lg text-sm input-field",placeholder:"City"}),(0,l.jsx)("input",{type:"text",value:i.prospect_state,onChange:e=>n({...i,prospect_state:e.target.value}),className:"px-3 py-2 rounded-lg text-sm input-field",placeholder:"State",maxLength:2}),(0,l.jsx)("input",{type:"text",value:i.prospect_zip,onChange:e=>n({...i,prospect_zip:e.target.value}),className:"px-3 py-2 rounded-lg text-sm input-field",placeholder:"Zip",maxLength:5})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Carrier *"}),(0,l.jsxs)("select",{value:i.carrier,onChange:e=>n({...i,carrier:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",children:[(0,l.jsx)("option",{value:"",children:"Select carrier"}),t.filter(e=>"string"==typeof e&&e).map(e=>(0,l.jsx)("option",{value:e,children:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())},e))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Policy Type"}),(0,l.jsx)("select",{value:i.policy_type,onChange:e=>n({...i,policy_type:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field",children:C.map(e=>(0,l.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Quoted Premium"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(j.Z,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,l.jsx)("input",{type:"number",step:"0.01",value:i.quoted_premium,onChange:e=>n({...i,quoted_premium:e.target.value}),className:"w-full pl-8 pr-3 py-2 rounded-lg text-sm input-field",placeholder:"847.00"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs font-medium mb-1 page-subtitle",children:"Effective Date"}),(0,l.jsx)("input",{type:"date",value:i.effective_date,onChange:e=>n({...i,effective_date:e.target.value}),className:"w-full px-3 py-2 rounded-lg text-sm input-field"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,l.jsx)("button",{onClick:s,className:"px-4 py-2 rounded-lg text-sm font-medium filter-chip",children:"Cancel"}),(0,l.jsxs)("button",{onClick:m,disabled:d,className:"flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold text-white",style:{background:"#0ea5e9"},children:[d?(0,l.jsx)(f.Z,{size:14,className:"animate-spin"}):(0,l.jsx)(o.Z,{size:14}),"Create Quote"]})]})]})})}function q(e){let{size:t}=e;return(0,l.jsx)(u.Z,{size:t})}function D(e){var t;let{quote:s,onClose:r,onRefresh:i}=e,[n,o]=(0,a.useState)(s),[h,g]=(0,a.useState)(!1),[j,C]=(0,a.useState)(!1),[Z,z]=(0,a.useState)(!1),[S,q]=(0,a.useState)(""),[D,P]=(0,a.useState)("6 months"),[L,F]=(0,a.useState)(""),[E,M]=(0,a.useState)("success"),Q=(0,a.useRef)(null),T=k[n.status]||k.quoted,G=async()=>{try{let e=await c.Go.get(n.id);o(e.data)}catch(e){}},R=async e=>{if(!e.name.toLowerCase().endsWith(".pdf")){F("Only PDF files allowed"),M("error");return}g(!0);try{await c.Go.uploadPDF(n.id,e),F("".concat(e.name," uploaded")),M("success"),await G(),i()}catch(e){var t,s;F((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.detail)||"Upload failed"),M("error")}finally{g(!1)}},A=async()=>{C(!0),F("");try{let e=await c.Go.sendEmail(n.id,{additional_notes:S||void 0,premium_term:D});e.data.email_sent?(F("Quote email sent successfully!"),M("success"),await G(),i()):(F(e.data.error||"Failed to send"),M("error"))}catch(s){var e,t;F((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Failed to send email"),M("error")}finally{C(!1)}},O=async()=>{try{await c.Go.markConverted(n.id),F("Marked as converted!"),M("success"),await G(),i()}catch(e){}},U=async()=>{let e=prompt("Reason for losing this quote?","Went with another carrier");if(null!==e)try{await c.Go.markLost(n.id,e),F("Marked as lost"),M("success"),await G(),i()}catch(e){}};return(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:r,children:(0,l.jsxs)("div",{className:"modal-bg rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto p-6",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-bold page-title",children:n.prospect_name}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,l.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat(T.bg," ").concat(T.text),children:T.label}),(0,l.jsxs)("span",{className:"text-xs page-subtitle capitalize",children:[null===(t=n.carrier)||void 0===t?void 0:t.replace(/_/g," ")," • ",n.policy_type]})]})]}),(0,l.jsx)("button",{onClick:r,className:"p-1 rounded hover:bg-white/10",children:(0,l.jsx)(b.Z,{size:18})})]}),L&&(0,l.jsxs)("div",{className:"flex items-center gap-2 p-3 mb-4 rounded-lg text-sm ".concat("success"===E?"bg-emerald-500/10 text-emerald-400":"bg-red-500/10 text-red-400"),children:["success"===E?(0,l.jsx)(y.Z,{size:14}):(0,l.jsx)(v.Z,{size:14}),L]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-5",children:[(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[n.prospect_email&&(0,l.jsxs)("div",{className:"flex items-center gap-2 page-subtitle",children:[(0,l.jsx)(N.Z,{size:13})," ",n.prospect_email]}),n.prospect_phone&&(0,l.jsxs)("div",{className:"flex items-center gap-2 page-subtitle",children:[(0,l.jsx)(_.Z,{size:13})," ",n.prospect_phone]}),(n.prospect_city||n.prospect_state)&&(0,l.jsx)("div",{className:"page-subtitle text-xs",children:[n.prospect_address,n.prospect_city,n.prospect_state,n.prospect_zip].filter(Boolean).join(", ")})]}),(0,l.jsxs)("div",{className:"text-right",children:[n.quoted_premium&&(0,l.jsxs)("p",{className:"text-2xl font-bold",style:{color:"#0ea5e9"},children:["$",n.quoted_premium.toLocaleString(void 0,{minimumFractionDigits:2})]}),(0,l.jsxs)("p",{className:"text-xs page-subtitle mt-1",children:["Producer: ",n.producer_name]}),n.effective_date&&(0,l.jsxs)("p",{className:"text-xs page-subtitle",children:["Effective: ",new Date(n.effective_date).toLocaleDateString()]})]})]}),n.email_sent&&(0,l.jsxs)("div",{className:"mb-5",children:[(0,l.jsx)("p",{className:"text-xs font-medium page-subtitle mb-2",children:"Pipeline Progress"}),(0,l.jsx)("div",{className:"flex items-center gap-1",children:[{label:"Sent",done:n.email_sent},{label:"3-Day",done:n.followup_3day_sent},{label:"7-Day",done:n.followup_7day_sent},{label:"14-Day",done:n.followup_14day_sent},{label:"Remarket",done:n.entered_remarket}].map((e,t)=>(0,l.jsxs)(a.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ".concat(e.done?"bg-cyan-500/20 text-cyan-300":"bg-white/5 text-gray-500"),children:[e.done?(0,l.jsx)(y.Z,{size:10}):(0,l.jsx)(u.Z,{size:10}),e.label]}),t<4&&(0,l.jsx)("div",{className:"w-4 h-0.5 ".concat(e.done?"bg-cyan-500/40":"bg-white/10")})]},t))})]}),(0,l.jsxs)("div",{className:"mb-5",children:[(0,l.jsx)("p",{className:"text-xs font-medium page-subtitle mb-2",children:"Quote PDF"}),n.pdf_uploaded?(0,l.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/20",children:[(0,l.jsx)(d.Z,{size:18,className:"text-emerald-400"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-emerald-300",children:n.pdf_filename}),(0,l.jsx)("p",{className:"text-xs text-emerald-400/60",children:"PDF attached — will be included in quote email"})]}),(0,l.jsx)("button",{onClick:()=>{var e;return null===(e=Q.current)||void 0===e?void 0:e.click()},className:"text-xs text-cyan-400 hover:underline",children:"Replace"})]}):(0,l.jsx)("div",{onDragOver:e=>{e.preventDefault(),z(!0)},onDragLeave:()=>z(!1),onDrop:e=>{e.preventDefault(),z(!1);let t=e.dataTransfer.files[0];t&&R(t)},onClick:()=>{var e;return null===(e=Q.current)||void 0===e?void 0:e.click()},className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ".concat(Z?"border-cyan-400 bg-cyan-400/10":"border-white/10 hover:border-white/20"),children:h?(0,l.jsx)(f.Z,{size:24,className:"mx-auto animate-spin text-cyan-400"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w.Z,{size:28,className:"mx-auto mb-2 text-gray-400"}),(0,l.jsx)("p",{className:"text-sm page-subtitle",children:"Drag & drop quote PDF here"}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"or click to browse"})]})}),(0,l.jsx)("input",{ref:Q,type:"file",accept:".pdf",className:"hidden",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&R(s),e.target.value=""}})]}),!n.email_sent&&n.prospect_email&&n.quoted_premium&&(0,l.jsxs)("div",{className:"mb-5 p-4 rounded-lg border border-white/10 bg-white/5",children:[(0,l.jsx)("p",{className:"text-sm font-medium page-title mb-3",children:"Send Quote Email"}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-3",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs page-subtitle mb-1",children:"Premium Term"}),(0,l.jsxs)("select",{value:D,onChange:e=>P(e.target.value),className:"w-full px-3 py-2 rounded-lg text-sm input-field",children:[(0,l.jsx)("option",{value:"6 months",children:"6 months"}),(0,l.jsx)("option",{value:"year",children:"Year"}),(0,l.jsx)("option",{value:"month",children:"Month"})]})]})}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"block text-xs page-subtitle mb-1",children:"Personal Note (optional)"}),(0,l.jsx)("textarea",{value:S,onChange:e=>q(e.target.value),rows:2,className:"w-full px-3 py-2 rounded-lg text-sm input-field",placeholder:"e.g., This is $120 less than your current carrier!"})]}),(0,l.jsxs)("button",{onClick:A,disabled:j,className:"flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold text-white w-full justify-center",style:{background:"#0ea5e9"},children:[j?(0,l.jsx)(f.Z,{size:14,className:"animate-spin"}):(0,l.jsx)(p.Z,{size:14}),"Send Quote Email ",n.pdf_uploaded?"+ PDF":"(no PDF attached)"]})]}),n.email_sent&&(0,l.jsxs)("div",{className:"flex items-center gap-2 p-3 mb-5 rounded-lg bg-blue-500/10 text-blue-400 text-sm",children:[(0,l.jsx)(y.Z,{size:14}),"Quote emailed on ",new Date(n.email_sent_at).toLocaleDateString()," at ",new Date(n.email_sent_at).toLocaleTimeString(),n.nowcerts_prospect_created&&" • NowCerts prospect created"]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:["converted"!==n.status&&"lost"!==n.status&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{onClick:O,className:"flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium bg-emerald-500/20 text-emerald-300 hover:bg-emerald-500/30 transition-colors",children:[(0,l.jsx)(x.Z,{size:14})," Won — Converted to Sale"]}),(0,l.jsxs)("button",{onClick:U,className:"flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:[(0,l.jsx)(m.Z,{size:14})," Lost"]})]}),"lost"===n.status&&n.lost_reason&&(0,l.jsxs)("div",{className:"text-xs page-subtitle",children:["Lost reason: ",n.lost_reason]})]})]})})}}},function(e){e.O(0,[597,228,888,774,179],function(){return e(e.s=9487)}),_N_E=e.O()}]);